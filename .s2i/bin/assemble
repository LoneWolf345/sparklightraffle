#!/bin/bash

# Custom S2I assemble script for Vite React application
# This script runs during the build phase

set -e

echo "==> Running custom assemble script..."

# Source the container user generation script if it exists
if [ -f /opt/app-root/etc/generate_container_user ]; then
    source /opt/app-root/etc/generate_container_user
fi

# Run the default S2I assemble script
echo "==> Running default S2I assemble..."
/usr/libexec/s2i/assemble

# Build the Vite application
echo "==> Building Vite application..."
npm run build

echo "==> Build complete!"
